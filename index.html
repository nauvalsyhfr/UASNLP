<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MedicIR - Sistem Pencarian Obat</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#f6fbff; --primary:#3b82c4; --muted:#6b7280; --card:#ffffff;
    --accent:#60a5fa; --danger:#ef4444; --glass: rgba(255,255,255,0.7);
    --shadow: 0 6px 20px rgba(38,84,130,0.08);
  }
  html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;scroll-behavior:smooth}
  body{background:linear-gradient(180deg,#eef6fb 0%, #ffffff 60%); color:#0f172a;}

  .med-floating {
    position:absolute;
    z-index:0;
    pointer-events:none;
    opacity:0.23;
    filter:blur(0.3px);
    animation:float 8s ease-in-out infinite;
  }

  .pill {
    width:75px;
    height:28px;
    background:linear-gradient(90deg,#3b82f6,#60a5fa);
    border-radius:20px;
    transform:rotate(20deg);
  }

  .node-graph {
    width:120px;
    height:120px;
    background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="8" fill="%233b82f6" opacity="0.4"/><circle cx="80" cy="30" r="8" fill="%2360a5fa" opacity="0.4"/><circle cx="50" cy="70" r="8" fill="%233b82f6" opacity="0.4"/><line x1="20" y1="20" x2="80" y2="30" stroke="%233b82f6" stroke-width="2" opacity="0.3"/><line x1="80" y1="30" x2="50" y2="70" stroke="%2360a5fa" stroke-width="2" opacity="0.3"/><line x1="50" y1="70" x2="20" y2="20" stroke="%233b82f6" stroke-width="2" opacity="0.3"/></svg>') no-repeat center/contain;
    opacity:0.17;
  }

  .vector-bubble {
    width:90px;
    height:90px;
    background:radial-gradient(circle,#e0f2ff,#b9ddff);
    border-radius:50%;
    box-shadow:0 0 20px rgba(59,130,246,0.25);
  }

  @keyframes float {
    0%,100% { transform:translateY(0px); }
    50% { transform:translateY(-18px); }
  }
  
  .landing-page{display:flex;flex-direction:column;min-height:100vh;overflow:hidden}
  .landing-header{background:linear-gradient(90deg,rgba(59,130,246,0.1),rgba(96,165,250,0.05)); padding:20px 40px; display:flex; align-items:center; justify-content:space-between; box-shadow:0 1px 3px rgba(15,23,42,0.08); position:relative; z-index:10; backdrop-filter:blur(10px)}
  .landing-brand{display:flex;align-items:center;gap:12px;animation:slideInLeft 0.8s ease-out}
  .landing-brand .logo{width:250px;height:40px;border-radius:8px;display:flex;align-items:center;justify-content:center;transition:transform 0.3s}
  .landing-brand .logo:hover{transform:scale(1.05)}
  .landing-brand .logo img{width:400%;height:400%;object-fit:contain;}
  .landing-nav{display:flex;gap:20px;align-items:center;color:var(--muted);font-size:14px;font-weight:500;animation:slideInRight 0.8s ease-out}
  .landing-nav div{cursor:pointer;transition:all 0.3s;padding:8px 16px;border-radius:8px;position:relative}
  .landing-nav div:hover{color:var(--primary);background:rgba(59,130,246,0.1);transform:translateY(-2px)}
  
  @keyframes slideInLeft{
    from{opacity:0;transform:translateX(-30px)}
    to{opacity:1;transform:translateX(0)}
  }
  
  @keyframes slideInRight{
    from{opacity:0;transform:translateX(30px)}
    to{opacity:1;transform:translateX(0)}
  }
  
  .landing-content{flex:1;display:flex;align-items:center;justify-content:center;padding:60px 20px 40px; position:relative}
  .landing-wrapper{max-width:1200px;width:100%;display:grid;grid-template-columns:1fr 1fr;gap:60px;align-items:center; position:relative; z-index:5;}
  .landing-left{display:flex;flex-direction:column;gap:24px;animation:fadeInUp 1s ease-out}
  
  @keyframes fadeInUp{
    from{opacity:0;transform:translateY(40px)}
    to{opacity:1;transform:translateY(0)}
  }
  
  .landing-left h1{
    font-family:Poppins,sans-serif;
    font-size:56px;
    margin:0;
    background:linear-gradient(135deg,#0b3b60 0%,#3b82c4 50%,#60a5fa 100%);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    background-clip:text;
    font-weight:800;
    line-height:1.1;
    letter-spacing:-1px;
    animation:gradientShift 3s ease infinite;
    background-size:200% 200%;
  }
  
  @keyframes gradientShift{
    0%,100%{background-position:0% 50%}
    50%{background-position:100% 50%}
  }
  
  .landing-left .slogan{
    color:var(--primary);
    font-size:22px;
    font-weight:600;
    margin:8px 0;
    font-style:italic;
    position:relative;
    display:inline-block;
    animation:slideIn 1.2s ease-out 0.3s both;
  }
  
  .landing-left .slogan::before{
    content:'';
    position:absolute;
    bottom:-4px;
    left:0;
    width:100%;
    height:3px;
    background:linear-gradient(90deg,var(--primary),var(--accent));
    border-radius:2px;
    animation:expandWidth 1s ease-out 0.8s both;
  }
  
  @keyframes expandWidth{
    from{width:0}
    to{width:100%}
  }
  
  @keyframes slideIn{
    from{opacity:0;transform:translateX(-20px)}
    to{opacity:1;transform:translateX(0)}
  }
  
  .subtitle-text{
    font-size:15px;
    color:var(--muted);
    margin-top:4px;
    font-weight:500;
    animation:slideIn 1.4s ease-out 0.5s both;
  }
  
  .landing-left .description{
    color:#4b5563;
    font-size:16px;
    line-height:1.7;
    margin:8px 0;
    animation:slideIn 1.6s ease-out 0.7s both;
  }
  
  .feature-highlights{
    display:grid;
    grid-template-columns:repeat(2,1fr);
    gap:12px;
    margin:16px 0;
    animation:slideIn 1.8s ease-out 0.9s both;
  }
  
  .feature-item{
    display:flex;
    align-items:center;
    gap:10px;
    padding:12px;
    background:rgba(59,130,246,0.05);
    border-radius:10px;
    border:1px solid rgba(59,130,246,0.1);
    transition:all 0.3s;
  }
  
  .feature-item:hover{
    background:rgba(59,130,246,0.1);
    border-color:var(--primary);
    transform:translateX(5px);
  }
  
  .feature-item::before{
    content:'âœ“';
    display:flex;
    align-items:center;
    justify-content:center;
    width:24px;
    height:24px;
    background:var(--primary);
    color:white;
    border-radius:50%;
    font-weight:700;
    font-size:14px;
    flex-shrink:0;
  }
  
  .feature-item span{
    font-size:14px;
    color:#374151;
    font-weight:500;
  }
  
  .landing-left .btn-start{
    display:inline-block;
    background:linear-gradient(135deg,var(--primary),var(--accent));
    color:white;
    padding:16px 40px;
    border-radius:12px;
    font-weight:700;
    font-size:17px;
    cursor:pointer;
    border:none;
    box-shadow:0 8px 24px rgba(59,130,246,0.3);
    transition:all 0.4s;
    text-decoration:none;
    width:fit-content;
    position:relative;
    overflow:hidden;
    animation:slideIn 2s ease-out 1.1s both;
  }
  
  .landing-left .btn-start::before{
    content:'';
    position:absolute;
    top:50%;
    left:50%;
    width:0;
    height:0;
    border-radius:50%;
    background:rgba(255,255,255,0.3);
    transform:translate(-50%,-50%);
    transition:width 0.6s,height 0.6s;
  }
  
  .landing-left .btn-start:hover::before{
    width:300px;
    height:300px;
  }
  
  .landing-left .btn-start:hover{
    transform:translateY(-3px) scale(1.02);
    box-shadow:0 12px 32px rgba(59,130,246,0.4);
  }
  
  .landing-left .btn-start:active{
    transform:translateY(0) scale(0.98);
  }
  
  .landing-left .btn-start span{
    position:relative;
    z-index:1;
  }
  
  .landing-right{
    display:flex;
    align-items:center;
    justify-content:center;
    position:relative;
    animation:fadeInScale 1.2s ease-out 0.5s both;
  }
  
  @keyframes fadeInScale{
    from{opacity:0;transform:scale(0.8)}
    to{opacity:1;transform:scale(1)}
  }
  
  .landing-right::before{
    content:'';
    position:absolute;
    width:120%;
    height:120%;
    background:radial-gradient(circle,rgba(59,130,246,0.15),transparent 70%);
    border-radius:50%;
    animation:pulse 3s ease-in-out infinite;
  }
  
  @keyframes pulse{
    0%,100%{transform:scale(1);opacity:0.5}
    50%{transform:scale(1.1);opacity:0.3}
  }
  
  .landing-right img{
    max-width:125%;
    height:auto;
    animation:floatSlow 6s ease-in-out infinite;
    border-radius:12px;
    position:relative;
    z-index:1;
    filter:drop-shadow(0 20px 40px rgba(59,130,246,0.2));
  }
  
  @keyframes floatSlow{
    0%,100%{transform:translateY(0) rotate(0deg)}
    50%{transform:translateY(-20px) rotate(2deg)}
  }
  
  .features-section{
    background:white;
    padding:80px 20px;
    margin-top:0;
    position:relative;
    overflow:hidden;
  }
  
  .features-section::before{
    content:'';
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:linear-gradient(135deg,rgba(59,130,246,0.03) 0%,transparent 50%);
    pointer-events:none;
  }
  
  .features-container{max-width:1200px;margin:0 auto;position:relative;z-index:1}
  .features-header{text-align:center;margin-bottom:60px;animation:fadeInUp 1s ease-out}
  .features-header h2{
    font-family:Poppins,sans-serif;
    font-size:42px;
    color:#0b3b60;
    margin:0 0 12px 0;
    font-weight:800;
    letter-spacing:-0.5px;
  }
  .features-header p{
    color:var(--muted);
    font-size:18px;
    max-width:600px;
    margin:0 auto;
  }
  .features-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:28px}
  .feature-card{
    background:white;
    border:2px solid #e5e7eb;
    border-radius:20px;
    padding:32px;
    transition:all 0.4s cubic-bezier(0.4,0,0.2,1);
    opacity:0;
    transform:translateY(30px);
    position:relative;
    overflow:hidden;
  }
  
  .feature-card::before{
    content:'';
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:4px;
    background:linear-gradient(90deg,var(--primary),var(--accent));
    transform:scaleX(0);
    transform-origin:left;
    transition:transform 0.4s;
  }
  
  .feature-card:hover::before{
    transform:scaleX(1);
  }
  
  .feature-card.visible{opacity:1;transform:translateY(0)}
  .feature-card:hover{
    border-color:var(--primary);
    transform:translateY(-8px);
    box-shadow:0 16px 40px rgba(59,130,196,0.15);
  }
  .feature-card h3{
    font-size:20px;
    font-weight:700;
    color:#0f172a;
    margin:0 0 12px 0;
    font-family:Poppins,sans-serif;
  }
  .feature-card p{color:var(--muted);font-size:15px;line-height:1.7;margin:0}
  
  @media(max-width:768px){
    .landing-wrapper{grid-template-columns:1fr;gap:40px}
    .landing-left h1{font-size:38px}
    .landing-nav{display:none}
    .features-grid{grid-template-columns:1fr}
    .feature-highlights{grid-template-columns:1fr}
  }
  
  .search-page{display:none}
  .search-page.active{display:flex;flex-direction:column;min-height:100vh}
  
  .site-header{background:linear-gradient(90deg, rgba(59,130,246,0.08), rgba(96,165,250,0.04)); padding:18px 40px; display:flex; align-items:center; justify-content:space-between; box-shadow:0 1px 0 rgba(15,23,42,0.03);}
  .brand{display:flex;align-items:center;gap:12px}
  .logo { width:250px;height:40px;border-radius:8px;display:flex;align-items:center;justify-content:center;transition:transform 0.3s}
  .logo:hover{transform:scale(1.05)}
  .logo img{width:400%;height:400%;object-fit:contain;}
  .brand div:last-child{display:none}
  .brand h1{font-size:18px;margin:0}
  .nav{display:flex;gap:18px; align-items:center; color:var(--muted);cursor:pointer}
  .nav div{padding:8px 16px;border-radius:8px;transition:all 0.3s}
  .nav div:hover{color:var(--primary);background:rgba(59,130,246,0.1);transform:translateY(-2px)}
  .hero{max-width:1100px;margin:28px auto;padding:28px 36px;background:transparent;display:grid;grid-template-columns:1fr 360px;gap:28px;align-items:center}
  .hero-left h2{font-size:34px;margin:0;color:#0b3b60;font-family:Poppins,sans-serif;font-weight:700}
  .hero-left p{color:var(--muted); margin-top:12px; line-height:1.5;font-size:15px}
  .hero-right{background:linear-gradient(180deg,#fff,#f7fbff); border-radius:12px; padding:18px; box-shadow:var(--shadow); text-align:center; transition:transform 0.3s; position:relative; overflow:hidden;}
  .hero-right:hover{transform:scale(1.02)}
  .hero-img { width:100%; border-radius:12px; box-shadow:var(--shadow); object-fit:cover; }
  .search-wrap{margin:18px 0 6px; display:flex; gap:12px; align-items:center}
  .search-input{flex:1; display:flex; background:var(--card); border-radius:12px; padding:10px 14px; align-items:center; box-shadow:0 6px 18px rgba(16,24,40,0.04); transition:box-shadow 0.3s}
  .search-input:focus-within{box-shadow:0 6px 24px rgba(59,130,246,0.15)}
  .search-input input{border:0; outline:0; width:100%; font-size:15px; padding:8px; background:transparent}
  .btn-search{background:var(--primary); color:white; border:none; padding:10px 18px; border-radius:10px; cursor:pointer; font-weight:600; box-shadow: 0 6px 18px rgba(59,130,246,0.18); transition:all 0.3s}
  .btn-search:hover{background:#2563eb;transform:translateY(-1px);box-shadow: 0 8px 22px rgba(59,130,246,0.25)}
  .btn-search:active{transform:translateY(0)}
  
  .example-queries{margin-top:12px}
  .example-queries p{font-size:13px;color:var(--muted);margin:0 0 8px 0}
  .example-tags{display:flex;flex-wrap:wrap;gap:8px}
  .example-tag{background:#f0f9ff;border:1px solid #e0f2fe;color:var(--primary);padding:6px 12px;border-radius:20px;font-size:13px;cursor:pointer;transition:all 0.2s}
  .example-tag:hover{background:var(--primary);color:white;border-color:var(--primary);transform:translateY(-1px)}
  
  .method-row{display:flex; gap:8px; margin-top:8px}
  .method-btn{border:1px solid rgba(15,23,42,0.06); background:white; padding:8px 12px; border-radius:8px; cursor:pointer; font-weight:600; color:var(--muted); transition:all 0.3s}
  .method-btn:hover{border-color:var(--primary);color:var(--primary)}
  .method-btn.active{background:var(--primary); color:white; border-color:var(--primary)}
  .container{max-width:1100px;margin:18px auto;padding:0 20px}
  .results{margin-top:20px; display:grid; grid-template-columns: 1fr; gap:14px}
  @media(min-width:980px){ .results{grid-template-columns: 1fr 1fr} .hero{grid-template-columns: 1fr 420px} }
  
  .card{
    background:var(--card); 
    border:2px solid #3b82c4; 
    border-radius:16px; 
    padding:20px; 
    box-shadow:none; 
    display:flex; 
    flex-direction:column; 
    gap:12px; 
    align-items:flex-start;
    position:relative;
    transition:all 0.3s;
    opacity:0;
    transform:translateY(20px);
    animation:cardFadeIn 0.5s forwards;
  }
  
  @keyframes cardFadeIn{
    to{opacity:1;transform:translateY(0)}
  }
  
  .card:hover{box-shadow:0 8px 24px rgba(59,130,196,0.15);transform:translateY(-3px)}
  
  .card .left{display:none}
  .card .body h3{margin:0;font-size:20px;font-weight:700;color:#0f172a}
  
  .card-header{
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    width:100%;
    gap:10px;
    flex-wrap:wrap;
    margin-bottom:4px;
  }
  
  .card-title-section{
    flex:1;
    min-width:0;
  }
  
  .card-badges{
    display:flex;
    flex-direction:column;
    gap:6px;
    align-items:flex-end;
  }
  
  .badge{
    display:inline-block;
    padding:8px 14px;
    border-radius:8px;
    font-weight:600;
    font-size:13px;
    color:white;
    background:var(--primary);
    text-transform:capitalize;
    white-space:nowrap;
  }
  
  .relevance-badge{
    background:#10b981;
    color:white;
    padding:6px 12px;
    border-radius:8px;
    font-size:12px;
    font-weight:600;
    white-space:nowrap;
  }
  
  .meta{color:var(--muted);font-size:13px;margin-top:0}
  .snippet{color:#4b5563;font-size:13px;line-height:1.5;margin-top:0}
  .empty-state{padding:50px 20px;text-align:center;color:var(--muted)}
  .empty-state .icon{font-size:46px;margin-bottom:12px}
  .spinner{width:36px;height:36px;border-radius:50%;border:4px solid rgba(59,130,246,0.15);border-top-color:var(--primary); animation:spin 1s linear infinite;margin:auto}
  @keyframes spin{to{transform:rotate(360deg)}}
  footer{max-width:1100px;margin:40px auto;padding:30px 20px;border-top:1px solid rgba(15,23,42,0.06);color:var(--muted); font-size:13px; text-align:center}
  .footer-info{margin-bottom:10px;line-height:1.6}
  .result-count{color:var(--muted); font-size:13px; margin-top:8px}
</style>
</head>
<body>

<div class="med-floating pill" style="top:14%; left:8%; animation-duration:9s;"></div>
<div class="med-floating pill" style="top:70%; left:80%; transform:rotate(-35deg); animation-duration:11s;"></div>
<div class="med-floating vector-bubble" style="top:30%; right:12%; animation-duration:12s;"></div>
<div class="med-floating node-graph" style="top:60%; left:45%; animation-duration:14s;"></div>
<div class="med-floating vector-bubble" style="top:78%; left:20%; width:70px;height:70px; animation-duration:10s;"></div>

<div class="landing-page" id="landingPage">
  <header class="landing-header">
    <div class="landing-brand">
      <div class="logo"><img src="app/static/medicir.png" alt="MedicIR Logo"></div>
    </div>
    <nav class="landing-nav">
      <div>Home</div>
      <div onclick="scrollToFeatures()">Fitur</div>
    </nav>
  </header>

  <div class="landing-content">
    <div class="landing-wrapper">
      <div class="landing-left">
        <div>
          <h1>MedicIR</h1>
          <div class="slogan">"Temukan Obat yang Tepat, dalam Sekejap"</div>
          <div class="subtitle-text">(Drug Information Retrieval System)</div>
        </div>
        
        <p class="description">Sistem pencarian obat cerdas berbasis kecerdasan buatan yang membantu Anda menemukan informasi obat yang akurat dan terpercaya dengan cepat dan mudah.</p>
        
        <div class="feature-highlights">
          <div class="feature-item">
            <span>Pencarian Cerdas</span>
          </div>
          <div class="feature-item">
            <span>Hasil Instan</span>
          </div>
          <div class="feature-item">
            <span>Data Terpercaya</span>
          </div>
          <div class="feature-item">
            <span>Mudah Digunakan</span>
          </div>
        </div>
        
        <button class="btn-start" id="btnStart"><span>Temukan Obat Sekarang</span></button>
      </div>

      <div class="landing-right">
        <img src="static/img/Group_7.png" alt="Drug Information System Illustration">
      </div>
    </div>
  </div>

  <div class="features-section" id="featuresSection">
    <div class="features-container">
      <div class="features-header">
        <h2>Kenapa Memilih MedicIR?</h2>
        <p>Teknologi pencarian cerdas untuk kesehatan Anda</p>
      </div>
      
      <div class="features-grid">
        <div class="feature-card">
          <h3>Pencarian Cerdas</h3>
          <p>Temukan obat dengan akurasi tinggi menggunakan teknologi pencarian yang memahami konteks dan maksud pencarian Anda.</p>
        </div>
        
        <div class="feature-card">
          <h3>Hasil Instan</h3>
          <p>Dapatkan hasil pencarian dalam hitungan detik dengan algoritma yang telah dioptimalkan untuk performa maksimal.</p>
        </div>
        
        <div class="feature-card">
          <h3>Informasi Lengkap</h3>
          <p>Akses informasi komprehensif tentang obat termasuk komposisi, indikasi, dosis, dan efek samping dalam satu tempat.</p>
        </div>
        
        <div class="feature-card">
          <h3>Pencarian Fleksibel</h3>
          <p>Cari berdasarkan nama obat, indikasi penyakit, atau komposisi aktif dengan hasil yang relevan dan akurat.</p>
        </div>
        
        <div class="feature-card">
          <h3>Data Terpercaya</h3>
          <p>Database obat yang ter-update dengan informasi yang telah diverifikasi dari sumber terpercaya.</p>
        </div>
        
        <div class="feature-card">
          <h3>Mudah Digunakan</h3>
          <p>Interface yang intuitif dan user-friendly membuat pencarian obat menjadi mudah untuk semua kalangan.</p>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <div class="footer-info">
      <strong>Kelompok B NLP SD-A1</strong><br>
      Teknologi Sains Data<br>
      Fakultas Teknologi Maju dan Multidisiplin<br>
      Universitas Airlangga
    </div>
    <div style="margin-top:15px;opacity:0.8">2025 MedicIR - Drug Information Retrieval System</div>
  </footer>
</div>

<div class="search-page" id="searchPage">
  <header class="site-header">
    <div class="brand">
      <div class="logo"><img src="static/img/medicir.png" alt="MedicIR Logo"></div>
    </div>
    <nav class="nav">
      <div id="backToHome">Home</div>
    </nav>
  </header>

  <section class="hero">
    <div class="hero-left">
      <h2>Temukan Obat-mu!</h2>
      <p>Cari obat berdasarkan nama, komposisi, atau indikasi penyakit. Sistem menggunakan teknologi pencarian cerdas untuk hasil yang relevan.</p>

      <div class="search-wrap">
        <div class="search-input" role="search">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="margin-right:10px;opacity:0.6"><path d="M21 21l-4.35-4.35" stroke="#9AA6B2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="11" cy="11" r="6" stroke="#9AA6B2" stroke-width="2"/></svg>
          <input id="q" type="search" placeholder="Ketik nama obat, komposisi, atau indikasi..." autocomplete="off" />
        </div>
        <button id="btnSearch" class="btn-search">Cari</button>
      </div>

      <div class="example-queries">
        <p><strong>Contoh pencarian:</strong></p>
        <div class="example-tags">
          <span class="example-tag" onclick="setQuery('obat sakit kepala paracetamol')">obat sakit kepala paracetamol</span>
          <span class="example-tag" onclick="setQuery('obat untuk diare anak')">obat untuk diare anak</span>
          <span class="example-tag" onclick="setQuery('obat batuk sirup')">obat batuk sirup</span>
          <span class="example-tag" onclick="setQuery('obat diabetes metformin')">obat diabetes metformin</span>
          <span class="example-tag" onclick="setQuery('salep untuk luka bakar')">salep untuk luka bakar</span>
        </div>
      </div>

      <div style="display:flex;align-items:center;gap:12px;margin-top:16px">
        <label style="color:var(--muted);font-size:13px">Tampilkan top 20 hasil</label>

        <div id="pager" style="margin-left:auto; display:flex; gap:8px; align-items:center">
          <button id="prevPage" class="method-btn" style="padding:8px 12px">Prev</button>
          <div id="pageLabel" style="color:var(--muted); font-size:13px">Halaman 1</div>
          <button id="nextPage" class="method-btn" style="padding:8px 12px">Next</button>
        </div>
      </div>
    </div>

    <div class="hero-right">
      <img class="hero-img" src="static/img/370.jpg" alt="Medicine illustration">
      <p style="margin-top:12px;color:var(--muted);font-size:13px">Cari informasi obat yang kamu butuhkan. Contoh: "obat sakit kepala paracetamol" atau "obat untuk diare anak".</p>
    </div>
  </section>

  <main class="container">
    <div id="resultCount" class="result-count" style="display:none"></div>

    <div id="resultsArea">
      <div class="empty-state" id="emptyState">
        <div class="icon">+</div>
        <div style="font-size:20px;font-weight:700;margin-top:8px">Hasil pencarian akan tampil di sini</div>
        <div style="margin-top:10px;color:var(--muted)">Masukkan query dan tekan cari untuk melihat hasil.</div>
      </div>
    </div>

    <div id="loading" style="display:none; margin-top:18px"><div class="spinner"></div></div>
  </main>

  <footer>
    <div class="footer-info">
      <strong>Kelompok B NLP SD-A1</strong><br>
      Teknologi Sains Data<br>
      Fakultas Teknologi Maju dan Multidisiplin<br>
      Universitas Airlangga
    </div>
    <div style="margin-top:15px;opacity:0.8">2025 MedicIR - Drug Information Retrieval System</div>
  </footer>
</div>

<script>
(function() {
  window.scrollToFeatures = function() {
    const featuresSection = document.getElementById('featuresSection');
    featuresSection.scrollIntoView({ behavior: 'smooth' });
  }

  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  };

  const observer = new IntersectionObserver(function(entries) {
    entries.forEach(function(entry, index) {
      if (entry.isIntersecting) {
        setTimeout(function() {
          entry.target.classList.add('visible');
        }, index * 100);
      }
    });
  }, observerOptions);

  document.querySelectorAll('.feature-card').forEach(function(card) {
    observer.observe(card);
  });

  const landingPage = document.getElementById('landingPage');
  const searchPage = document.getElementById('searchPage');
  const btnStart = document.getElementById('btnStart');
  const backToHome = document.getElementById('backToHome');

  btnStart.addEventListener('click', function() {
    landingPage.style.display = 'none';
    searchPage.classList.add('active');
  });

  backToHome.addEventListener('click', function() {
    searchPage.classList.remove('active');
    landingPage.style.display = 'flex';
    document.getElementById('q').value = '';
    document.getElementById('resultsArea').innerHTML = '<div class="empty-state" id="emptyState"><div class="icon">+</div><div style="font-size:20px;font-weight:700;margin-top:8px">Hasil pencarian akan tampil di sini</div><div style="margin-top:10px;color:var(--muted)">Masukkan query dan tekan cari untuk melihat hasil.</div></div>';
  });

  window.setQuery = function(query) {
    document.getElementById('q').value = query;
    doSearch(true);
  }

  const qEl = document.getElementById('q');
  const btn = document.getElementById('btnSearch');
  const resultsArea = document.getElementById('resultsArea');
  const loading = document.getElementById('loading');
  const emptyState = document.getElementById('emptyState');
  const resultCount = document.getElementById('resultCount');
  const prevBtn = document.getElementById('prevPage');
  const nextBtn = document.getElementById('nextPage');
  const pageLabel = document.getElementById('pageLabel');
  
  const perPage = 20;
  const currentMethod = 'hybrid';
  const API_BASE_URL = 'http://127.0.0.1:8000';

  let currentPage = 0;
  let lastResponse = null;

  function updatePagerUI(page) {
    pageLabel.textContent = 'Halaman ' + (page + 1);
    prevBtn.disabled = page <= 0;
  }

  async function doSearch(isNew){
    const q = qEl.value.trim();
    if(!q) {
      resultsArea.innerHTML = '';
      resultsArea.appendChild(emptyState.cloneNode(true));
      return;
    }
    if (isNew) currentPage = 0;

    loading.style.display = "block";
    if(emptyState) emptyState.style.display = "none";
    resultCount.style.display = "none";

    try {
        const url = `${API_BASE_URL}/search?query=${encodeURIComponent(q)}&method=${currentMethod}&per_page=${perPage}&page=${currentPage}&top_k=100`;

        const resp = await fetch(url, {
          method: 'GET',
          headers: { 'Accept': 'application/json' }
        });
      
      if (!resp.ok) {
        throw new Error('Server error: ' + resp.status + ' ' + resp.statusText);
      }
      
      const j = await resp.json();
      loading.style.display = "none";

      // ============================================================================
      // VALIDATION HANDLING - Integrated (No HTML/CSS changes)
      // ============================================================================
      
      if (j.validation && !j.validation.is_valid) {
        resultsArea.innerHTML = '';
        const el = document.createElement('div');
        el.className = 'empty-state';
        
        let icon = 'X';
        let title = 'Obat Tidak Ditemukan';
        let message = 'Coba ubah kata kunci atau coba contoh pencarian di atas.';
        
        if (j.validation.reason === 'non_medical_query') {
          icon = 'â„¹ï¸';
          title = 'Query Tidak Relevan';
          message = '"' + escapeHtml(q) + '" tidak berhubungan dengan obat atau kesehatan. Silakan coba kata kunci yang berkaitan dengan obat atau gejala penyakit seperti: obat diare, paracetamol, vitamin C, antibiotik.';
        } else if (j.validation.reason === 'no_relevant_results') {
          icon = 'ðŸ”';
          title = 'Obat Tidak Ditemukan';
          message = 'Obat "' + escapeHtml(q) + '" tidak ditemukan dalam database. Coba gunakan kata kunci lain atau periksa ejaan. Contoh: obat batuk, obat flu, sakit kepala.';
        } else if (j.validation.reason === 'low_confidence') {
          icon = 'â“';
          title = 'Hasil Tidak Relevan';
          message = 'Tidak ada hasil yang cukup relevan untuk "' + escapeHtml(q) + '". Coba kata kunci yang lebih spesifik terkait obat atau penyakit.';
        }
        
        el.innerHTML = '<div class="icon">' + icon + '</div><div style="font-size:20px;font-weight:700;margin-top:8px">' + title + '</div><div style="margin-top:10px;color:var(--muted)">' + message + '</div>';
        resultsArea.appendChild(el);
        updatePagerUI(0);
        return;
      }
      
      // ============================================================================
      // END VALIDATION
      // ============================================================================

      if(!j.results || j.results.length === 0){
        resultsArea.innerHTML = '';
        const el = document.createElement('div');
        el.className = 'empty-state';
        el.innerHTML = '<div class="icon">X</div><div style="font-size:20px;font-weight:700;margin-top:8px">Hasil pencarian tidak ditemukan</div><div style="margin-top:10px;color:var(--muted)">Coba ubah kata kunci atau coba contoh pencarian di atas.</div>';
        resultsArea.appendChild(el);
        updatePagerUI(0);
        return;
      }

      resultsArea.innerHTML = '';
      const grid = document.createElement('div');
      grid.className = 'results';
      j.results.forEach(function(r, idx) {
        const card = document.createElement('div');
        card.className = 'card';
        card.style.animationDelay = (idx * 0.05) + 's';
        
        const relevance = r.score ? Math.min(Math.round(r.score * 100), 100) : 0;
        
        let badgesHTML = '';
        if (r.tipe) {
          badgesHTML += '<span class="badge">' + escapeHtml(r.tipe) + '</span>';
        }
        if (relevance > 0) {
          badgesHTML += '<span class="relevance-badge">' + relevance + '% Relevan</span>';
        }
        
        card.innerHTML = '<div class="card-header"><div class="card-title-section"><h3 style="margin:0;font-size:18px;font-weight:700;color:#0f172a">' + escapeHtml(r.nama || r.id) + '</h3></div>' + (badgesHTML ? '<div class="card-badges">' + badgesHTML + '</div>' : '') + '</div><div class="meta"><strong>Komposisi:</strong> ' + escapeHtml(r.komposisi || '-') + '</div><div class="snippet"><strong>Indikasi:</strong> ' + escapeHtml(truncate(r.indikasi_umum || r.indikasi || r.snippet || '', 280)) + '</div>';
        grid.appendChild(card);
      });
      resultsArea.appendChild(grid);

      lastResponse = j;
      updatePagerUI(currentPage);
      resultCount.style.display = "block";

      const total = j.total_results || j.results.length;
      const start = currentPage * perPage + 1;
      const end = start + j.results.length - 1;
      resultCount.textContent = 'Menampilkan ' + start + '-' + end + ' dari ' + total + ' hasil (' + j.method_used + ')';
      nextBtn.disabled = !j.has_more;

      window.scrollTo({top: document.querySelector('.hero').offsetTop, behavior:'smooth'});
    } catch(err){
      loading.style.display = "none";
      resultsArea.innerHTML = '';
      const el = document.createElement('div');
      el.className = 'empty-state';
      el.innerHTML = '<div class="icon">!</div><div style="font-size:18px;font-weight:700;margin-top:8px">Terjadi kesalahan</div><div style="margin-top:10px;color:var(--muted)">' + escapeHtml(err.message || 'Unknown') + '</div>';
      resultsArea.appendChild(el);
      updatePagerUI(0);
    }
  }

  btn.addEventListener('click', function() {
    doSearch(true);
  });
  
  qEl.addEventListener('keydown', function(e) {
    if(e.key === 'Enter') doSearch(true);
  });

  prevBtn.addEventListener('click', function() {
    if(currentPage > 0) {
      currentPage -= 1;
      doSearch(false);
    }
  });
  
  nextBtn.addEventListener('click', function() {
    currentPage += 1;
    doSearch(false);
  });

  updatePagerUI(0);

  function truncate(s, n){
    if(!s) return '';
    if(s.length <= n) return s;
    return s.slice(0, n - 1) + '...';
  }
  
  function escapeHtml(s){
    return String(s || '').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;').replace(/'/g, '&#39;');
  }
})();
</script>
</body>
</html>